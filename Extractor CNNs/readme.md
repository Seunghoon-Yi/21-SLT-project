S3D encoder modified from [Here](https://github.com/kylemin/S3D)
